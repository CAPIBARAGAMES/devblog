# Nombre del flujo de trabajo
name: Despliegue Automatico de Hugo a HostGator

# Eventos que disparan el flujo (cada vez que se haga push a la rama 'main')
on:
  push:
    branches:
      - main
  workflow_dispatch: # Permite ejecutarlo manualmente desde GitHub

# Tareas a ejecutar
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
      # 1. Checkout del repositorio
      - name: Checkout del codigo y Submodules
        uses: actions/checkout@v4
        with:
          submodules: true  # Esto es CRUCIAL para descargar el tema PaperMod
          fetch-depth: 0    
          
      # 2. Configurar el entorno de Go
      - name: Setup Go environment
        uses: actions/setup-go@v5
        with:
          go-version: '1.22' 

      # 3. Descargar Hugo Extended (necesario para PaperMod)
      - name: Descargar Hugo Extended
        uses: peaceiris/actions-hugo@v3
        with:
          hugo-version: 'latest'
          extended: true # ¡VITAL para evitar errores de CSS!

      # 4. Compilar el sitio de Hugo
      - name: Construir el Sitio (Modo Produccion)
        run: hugo --minify
      
# ... (Código anterior)

      # 5. Desplegar a HostGator usando FTP (¡Corregido!)
      - name: Desplegar via FTP
        uses: SamKirkland/FTP-Deploy-Action@v4.3.0
        with:
          server: ${{ secrets.FTP_HOST }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          # Renombrado de 'local-directory' a 'local-dir'
          local-dir: ./public/
          # Renombrado de 'server-directory' a 'server-dir'
          server-dir: ${{ secrets.FTP_PATH }}
          
          # La opción 'delete-test' fue reemplazada. 
          # Usamos 'dry-run: false' para indicar que no es una prueba.
          dry-run: false 
          
          # La opción 'timeout' ya no es soportada como antes, la eliminamos.
          # Eliminamos: timeout: 120000